;(function() {
  'use strict';

  videojs.plugin('timeEvent', function(options) {
    var player = this,
        _options = options || {},
        _lastTime = 0;

    _options.interval = _options.interval || 15;

    /*console.log('player: ', player);
    console.log('player.el(): ', player.el());
    console.log('_options: ', _options);*/

    var _interval = player.setInterval(function() {
      // console.log('player.currentTime(): ', player.currentTime());
      var currentTime = player.currentTime();
      if ( (currentTime - _lastTime) >= _options.interval ||
           (currentTime - _lastTime) <= -_options.interval ) {
        _lastTime = currentTime;
        // console.log('_lastTime: ', _lastTime);

        player.trigger('timeEvent');
      }

    }, 1000);

    player.on('ended', function() {
      player.clearInterval(_interval);
    });

    player.on('error', function() {
      player.clearInterval(_interval);
    });

  });

})();
